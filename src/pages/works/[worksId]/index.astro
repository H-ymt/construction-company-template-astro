---
import Layout from "../../../layouts/Layout.astro";
import { getWorksDetail, getWorks } from "../../../libs/microcms";
import type { Works } from "../../../libs/microcms";
import Sheet from "../../../components/Sheet.astro";
import Section from "../../../components/Section.astro";
import PageTitle from "../../../components/PageTitle.astro";

// 詳細ページの全パスを取得
export async function getStaticPaths() {
  const response = await getWorks({ fields: ["id"] });

  return response.contents.map((content: Works) => ({
    params: {
      worksId: content.id,
    },
  }));
}

// 施工実績の詳細情報を取得
const { worksId } = Astro.params;
const works = await getWorksDetail(worksId as string);
---

<Layout title={`${works.title} - 施工実績`} commonjs="./js/common.js">
  <Sheet>
    <Section>
      <div class="flex flex-col items-center">
        <PageTitle eng="">{works.title}</PageTitle>

        <div class="w-full max-w-[720px]">
          <img
            src={works.thumbnail?.url}
            width={works.thumbnail?.width}
            height={works.thumbnail?.height}
            alt=""
            class="rounded-xl"
          />

          <p set:html={works.body} class="mt-6 text-justify" />
        </div>
      </div>
    </Section>
  </Sheet>
</Layout>
